<h2 style="margin-left: 0px;"><span style="color: rgb(255, 0, 0);"><strong>refer :&nbsp;http://my.oschina.net/amince/blog/182210?fromerr=QI7de2KL</strong></span></h2><p style="margin-left:0"><strong><br/></strong></p><p style="margin-left:0"><strong><span style="font-family:&#39;微软雅黑&#39;,sans-serif"><a href="#_Toc442034123">一、一、有限自动机定义及基本术语：</a></span></strong><a href="#_Toc442034123"><span style="color:windowtext;display:none;text-underline:none">... </span><span style="color:windowtext;display:none;text-underline:none">1</span></a></p><p style="margin-left:0"><a href="#_Toc442034124"><strong><span style="font-family:&#39;微软雅黑&#39;,sans-serif">二、引入的函数定义:</span></strong> <span style="color:windowtext;display:none;text-underline:none">2</span></a></p><p style="margin-left:0"><a href="#_Toc442034125"><strong><span style="font-family:&#39;微软雅黑&#39;,sans-serif">三、字符串匹配自动机(string-matching automation)</span></strong><span style="color:windowtext;display:none;text-underline:none">. </span><span style="color:windowtext;display:none;text-underline:none">3</span></a></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="margin: 10px 0;line-height: 25px;background: white"><a name="_Toc442034123"></a><strong><span style=";font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333">一、一、有限自动机定义及基本术语：</span></strong></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">一个有限自动机 M 是一个5元组（Q, q0，A, Σ, δ），其中： </span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">Q </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">是所有状态的有限集合;</span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">q0 </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">∈ Q (属于)是初始状态;</span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">A </span><span style="font-size:13px;font-family:&#39;Cambria Math&#39;,serif;color:#333333;letter-spacing:1px">?</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px"> Q </span><span style="font-size:13px;font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">（子集）是接受状态的集合;(对应于多模式？)</span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">Σ 是有限输入字母表;</span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">δ 是从Q * Σ的转移函数，称为有限自动机M的转移函数;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">记号与术语：<br/> Σ*&nbsp; 表示用字母表Σ中所有字符形成的所有有限长度的字符串集合.<br/> n&nbsp;&nbsp; 输入字符串(input string)的长度.<br/> m&nbsp; 模式字符串(pattern string)的长度；也称作终态m，当状态为m时表示，m长度的模式串匹配成功.</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">|x| : </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">字符串x的长度, 如示符号记法.</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"><img src="/HXBlog/upload/image/20160131/1454242651606073924.jpg" title="1454242651606073924.jpg" alt="103237_e1ti_227203.jpg"/>&nbsp; : </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">字符串w 是字符串x 的前缀，如示符号记法.</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"><span style="color: rgb(51, 51, 51); font-family: 微软雅黑, sans-serif; font-size: 13px; letter-spacing: 1px; line-height: 23px; background-color: rgb(255, 255, 255);"></span><span style="color: rgb(51, 51, 51); font-family: 微软雅黑, sans-serif; font-size: 13px; letter-spacing: 1px; line-height: 23px; background-color: rgb(255, 255, 255);"></span><span style="color: rgb(51, 51, 51); font-family: 微软雅黑, sans-serif; font-size: 13px; letter-spacing: 1px; line-height: 23px; background-color: rgb(255, 255, 255);"></span><img src="/HXBlog/upload/image/20160131/1454242555233002367.png"/>&nbsp;: </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">字符串w 是字符串x 的后缀，如示符号记法.（注意前缀/后缀均遵循传递规则）</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">ε：表示空字符串，是所有字符串的后缀，前缀. (ε读作 epsilon )</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">a : </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">下文中的字符a泛指所有字符(a∈Σ)，不特指字符&#39;a&#39;.</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 10px 0;line-height: 25px;background: white"><a name="_Toc442034124"></a><strong><span style=";font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333">二、引入的函数定义:</span></strong></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">转移函数δ（transition function） ( δ 读作&quot;delta&quot;,对应大写为 Δ )</span></p><p style="margin-bottom: 16px;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">有限自动机开始于初始状态q0，每次读入输入字符串的一个字符，如果有限自动机在状态q是读入字符&#39;a&#39;,&nbsp; <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 则M状态从q变成 δ(q, a); <br/> <br/> </span></p><p style="margin-left: 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">终态函数 Φ（finite state function） ( Φ 读作&quot;fai&quot;, 对应小写为 φ )</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">是从 Σ* 到 Q 的函数,Φ(w)是永动机M 扫描字符串 w 终止后的状态；M 接受字符串w 当且仅当Φ(w)∈A, 函数Φ有下列递归关系定义： <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;φ(ε) = q0;（空字符串 ε 的终态为q0）</span></p><p style="margin-bottom: 16px;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">φ(wa) = δ(φ(w),a) (其中w∈Σ*，a∈Σ) <br/> <br/> </span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">辅助函数，后缀函数σ 对应于模式字串P&nbsp; ( σ 读作 &quot;sigma&quot;, 对应大写为 Σ )</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">是从Σ* 到{0,1, ..., m}上的映射，σ(x)是字符串x的后缀同时是P的前缀的最大长度； <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; σ(x) = max{k: P</span><span style="font-size:10px;font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">k</span> <span style="font-size:13px;font-family: &#39;MS Gothic&#39;;color:#333333;letter-spacing:1px">?</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"> x } <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 有P0 = ε是所有所有字符串的后缀; </span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">* </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">后缀函数的主要意义的是求出当前匹配失败时，求出已经匹配过的部分字串x是否是待匹配模式字串P的前缀，即匹配可以跳过x中部分长度( σ(x) ),可以用于实现转移过程;同时也表明在接受输入字符串x后的状态(终态)，即也用于实现终态函数。</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 10px 0;line-height: 25px;background: white"><a name="_Toc442034125"></a><strong><span style=";font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333">三、字符串匹配自动机(string-matching automation)</span></strong></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">下图是依据模式串 P=&quot;ababaca&quot; 构建的自动机图表：</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"><img src="/HXBlog/upload/image/20160131/1454242684738064872.jpg" title="1454242684738064872.jpg" alt="112750_EW93_227203.jpg"/>&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">上图(a)是一个自动机的状态转换图表,接受所有以字符串&quot;ababaca&quot;结尾的字符串。其中状态0是初始状态，状态7是唯一接受状态(单模式匹配).</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">1) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">从状态i到状态j的带箭头的有向边表示转移过程: δ(i, a) = j(a∈Σ).</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">2) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">右向边组成了自动机的主要&quot;骨架&quot;，图中粗线部分，对应于输入字符同模式字串匹配成功的转移过程。左向边对应于匹配失败的转移过程(跳转,主要是计算已经匹配的部分字串 的后缀子串同时是模式串P的前缀的最大长度).部分匹配失败的过程没有标示出来。</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">3) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">图中部分状态i在接受某字符a(a∈Σ)时，没有标示出对应有向边的情况表明其转移过程为: δ(i, a) = 0(a∈Σ),根据下面字符串模式匹配自动机定义，知当前已经匹配子串没有后缀字串是模式串P的前缀。如在状态3时，输入字符为&#39;c&#39;,即在已经匹配了&quot;aba&quot;这时接受字符&#39;c&#39;，知当前已匹配字串为&quot;abac&quot;,对应模式字串P=&quot;ababaca&quot;，可知这时匹配失败，进行失败跳转求&quot;abac&quot;后缀子串同时是模式串P前缀的最大长度，可知为0.</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">4) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">匹配成功的转移过程(对应状态，以及对应输入字符)均标示为灰色,</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">5) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">表(c)是自动机在处理(接受)输入文本T=&quot;abababacaba&quot;的最终状态表。当输入字符T[i]时，此时字串T[0...i]对应的的最终状态φ(T[0...i]) 同表(c)最后一列一一对应。有T[&quot;abababaca&quot;] = P.length = 7(唯一接受状态)，即这时候在T串中匹配成功模式串P，结束位置为9，起始位置为(9-P.length+1)=3。</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">1</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">、字符串匹配有限自动机定义:</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">给定模式(pattern)字符串 P[1...m],其对应的字符串匹配有限自动机定义如下:</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">1</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">、状态集Q = {0,1,...m}，开始状态q0 是状态0，state m 是唯一的接受状态；</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">2</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">、转移函数δ 可以用后缀函数来表示 (这个很重要， 因为状态转移函数是个抽象概念，而后缀函数可以用code表示) :</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">δ(q,a) = σ（Pq,a）&nbsp;&nbsp; &lt;等式一&gt;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">假设当前已经读入的字符串为T,为了让T的字串(以T[i]为结尾) 能匹配模式字串Pj,必须满足Pj是Ti的后缀;同时假设q = φ(Ti),说明读取字串Ti后自动机M 状态变成q；同时根据转移函数&lt;等式一&gt;可知q是模式字串P最大长度的前缀，同时是Ti的后缀；因此在状态q，有Pq </span><span style="font-size:13px;font-family:&#39;MS Gothic&#39;;color:#333333;letter-spacing:1px">?</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"> Ti 和 q = σ(Ti) （当q 等于m 时，说明模式字串P整个是Ti的后缀，也意味着匹配查找成功了），因此有σ(Ti)= q，得出永动机也支持下面的等式(终态函数也是抽象的，转化为后缀函数表达式后，可以用code表示)：</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">φ(Ti) = σ(Ti)（i = 0,1,...n）&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;等式二&gt;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"><br/> <br/> 2</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">、同时有两个引理(具体证明可以参考算法导论)： </span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">引理1、后缀函数不等式：</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">σ(xa) ≤ σ(x) + 1 (对于任何字符串x，以及字母a) </span></p><p style="margin: 8px 0 8px 20px;line-height: 23px;background: white"><span style="font-size:13px;font-family:Symbol;color:#333333;letter-spacing:1px">・<span style="font-stretch: normal;font-size: 9px;line-height: normal;font-family: &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">引理2、后缀函数递归引理：</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing: 1px">对于任何字符串x，以及字母a，如果q = σ(x),有： <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; σ(xa) = σ(Pqa) <br/> <br/> <br/> &lt;等式二&gt; 可以用数学归纳法证明，具体如下:<br/> 1、当i = 0，因为T0 = ε，因此有φ(Ti) = 0 = σ(Ti) <br/> 2、假设φ(Ti) = σ(Ti)，证明φ(Ti+1) = σ(T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">i</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">+1)</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">，用q 表示φ(Ti)，用字母a表示T[i+1],有： <br/> φ(Ti+1) = φ(T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">ia</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">) (Ti+1 == Tia) <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">δ(φ(Ti),a) (根据终态函数的定义) <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = δ(q,a) （根据q的定义） <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = σ(P</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">qa</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">) </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">（根据等式一） <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = σ(T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">ia</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">) (</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">根据引理二) <br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = σ(T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">i</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">+1) (T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">i</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">+1 == T</span><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">ia</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">)</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">从上面可以知道当读入T </span><span style="font-size:9px;font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">i</span> <span style="font-size:13px;font-family: &#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">的终态(亦即读入T[i]后转移函数状态)等于模式长度，就匹配成功了，下面是有限自动机机匹配算法伪代码： </span></p><p style="line-height: 23px;background: white"><img src="/HXBlog/upload/image/20160131/1454242694176008855.bmp" title="1454242694176008855.bmp" alt="213009_L1yY_227203.bmp"/></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">下面就是根据&lt;等式一&gt;来实现转移函数的伪代码：</span></p><p style="line-height: 23px;background: white"><img src="/HXBlog/upload/image/20160131/1454242716711077863.bmp" title="1454242716711077863.bmp" alt="213411_ufLI_227203.bmp"/></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">下面是我自己实现的code：</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:red;letter-spacing:1px">注</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px"> : </span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">这里的代码, 我替换为了我的代码, 想看原作者的代码, 详见refer</span></p><p><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">class</span></strong><span style="font-size: 16px;font-family: Consolas"> Test01FiniteAutomata {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">字符串匹配</span> <span style="font-size:16px;font-family:宋体;color:#3F7F5F">之自动机</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">void</span></strong><span style="font-size: 16px;font-family: Consolas"> main(String[] args) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = </span><span style="font-size:16px;font-family:Consolas;color:#2A00FF">&quot;abababacaba&quot;</span><span style="font-size: 16px;font-family: Consolas">;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String pat = </span><span style="font-size:16px;font-family:Consolas;color:#2A00FF">&quot;ababaca&quot;</span><span style="font-size: 16px;font-family: Consolas">;</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp; String <span style="text-decoration:underline;">str</span> = &quot;98745968439805lkrj&quot;;</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp; String pat = &quot;98&quot;;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>finiteAutoMata</em>(str, pat);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size:16px;font-family: Consolas">&nbsp;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">自动机算法</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">首先</span> <span style="font-size:16px;font-family:宋体;color:#3F7F5F">创建自动机的状态转换图</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">然后在计算</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">str</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中各个</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">[0, <span style="text-decoration:underline;">len</span>]</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">的子串的状态</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// check, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">如果该子串的状态为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pat, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">则说明该子串以</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pat</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">结尾</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">通过思考一下整个计算的性质</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">可以发现</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">kmp</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">算法</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&nbsp; </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">和这个非常像啊</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">..</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">参数</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">// Q </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">是所有状态的有限集合</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 0 -&gt; pat.length</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">// q0 </span><span style="font-size:16px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#3F7F5F">∈</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F"> Q (</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">属于</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">)</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">是初始状态</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 0</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">// A </span><span style="font-size:16px;font-family:&#39;Cambria Math&#39;,serif;color:#3F7F5F">?</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F"> Q </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">（子集）是接受状态的集合</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">各个子串</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">[</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">状态转换表中不为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">0</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">的对应的</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">子串</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">] </span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">// Σ </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">是有限输入字母表</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // pat</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中的各个字符</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">[<span style="text-decoration:underline;">abca</span> -&gt; a, b, c]</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">// δ </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">是从</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">Q * Σ</span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">的转移函数，称为有限自动机</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">M</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">的转移函数</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">;&nbsp; // <span style="text-decoration:underline;">func</span>(curState, newChar) = newState; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">void</span></strong><span style="font-size: 16px;font-family: Consolas"> finiteAutoMata(String str, String pat) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// 1. </span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">创建所有的字符的映射</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp; Map&lt;Character, Integer&gt; idxMap = createIndexMap(<span style="text-decoration:underline;">str</span>, pat);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// 2. </span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">仅仅创建</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pat</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中所有字符的映射</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;Character, Integer&gt; idxMap = <em>createIndexMap02</em>(str, pat);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">自己的思路</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[][] transformGraph = <em>createTransformGraph</em>(pat, idxMap);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">参见算法导论</span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp; <span style="text-decoration:underline;">int</span>[][] transformGraph = createTransformGraph02(pat, idxMap);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[] statuses = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">new</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[str.length()+1];</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;str.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// 1. </span></p><p><span style="font-size:16px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; statuses[i+1] = transformGraph[statuses[i] ][idxMap.get(str.charAt(i)) ];</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// 2.</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(! idxMap.containsKey(str.charAt(i)) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; statuses[i+1] = 0;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">else</span></strong><span style="font-size: 16px;font-family: Consolas"> {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; statuses[i+1] = transformGraph[statuses[i] ][idxMap.get(str.charAt(i)) ];</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;statuses.</span><span style="font-size:16px;font-family:Consolas;color:#0000C0">length</span><span style="font-size: 16px;font-family: Consolas">; i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(statuses[i] == pat.length()) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Log.<em>log</em>(str.substring(0, i) );</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size:16px;font-family: Consolas">&nbsp;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">创建状态转换图</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">使用给定的</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">以及各个字符索引映射</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">遍历</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">pattern, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">二级遍历</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">idxMap</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">如果给定的字符为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">当前字符</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">则令其为</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">idx</span></span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">递增</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">idx</span></span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">否则</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">&nbsp; </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">假设添加该字符</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取该字符串在原</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中的最长子串的长度</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">最后</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">&nbsp; </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取如果完全匹配</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">之后</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">如果还有下一个字符的话</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取该字符对应的索引</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F"> [</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">比如</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&quot;<span style="text-decoration:underline;">abab</span>&quot;, </span><span style="font-size: 16px;font-family:宋体;color:#3F7F5F">如果找到一个</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&quot;<span style="text-decoration:underline;">abab</span>&quot;</span><span style="font-size: 16px;font-family:宋体;color:#3F7F5F">的子串的话</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">那么如果接下来两个字符为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&quot;<span style="text-decoration:underline;">ab</span>&quot;</span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">的话</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">[&quot;<span style="text-decoration:underline;">ababab</span>&quot;], </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">就又可以构成一个给定的字符串了</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">] [</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">主要用于处理</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">在给定的字符串中嵌套出现的场景</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">]</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">private</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[][] createTransformGraph(String pat, Map&lt;Character, Integer&gt; idxMap) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[][] transformGraph = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">new</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[pat.length()+1][idxMap.size()];</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> idx = 1;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;pat.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Character ch = pat.charAt(i);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(Entry&lt;Character, Integer&gt; entry : idxMap.entrySet() ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(entry.getKey().equals(ch) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transformGraph[i][idxMap.get(entry.getKey())] = idx ++;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">else</span></strong><span style="font-size: 16px;font-family: Consolas"> {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transformGraph[i][idxMap.get(entry.getKey())] = <em>getTransformTo</em>(pat.substring(0, i), entry.getKey());</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(Entry&lt;Character, Integer&gt; entry : idxMap.entrySet() ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transformGraph[pat.length()][idxMap.get(entry.getKey())] = <em>getTransformTo</em>(pat, entry.getKey());</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> transformGraph;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">参见算法导论</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">private</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[][] <span style="text-decoration:underline;">createTransformGraph02(String pat, Map&lt;Character, Integer&gt; idxMap)</span> {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[][] transformGraph = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">new</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas">[pat.length()+1][idxMap.size()];</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;=pat.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(Entry&lt;Character, Integer&gt; entry : idxMap.entrySet() ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = pat.substring(0, i) + entry.getKey();</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> k=i+1; k&gt;=0; k--) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String subPat = pat.substring(0, ((k &lt;= pat.length()) ? k : k-1 ) );</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(str.endsWith(subPat) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transformGraph[i][idxMap.get(entry.getKey())] = k;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">break</span></strong><span style="font-size: 16px;font-family: Consolas"> ;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> transformGraph;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取</span><span style="font-size: 16px;font-family:Consolas;color:#3F7F5F">pat</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中的各个字符</span> <span style="font-size:16px;font-family:宋体;color:#3F7F5F">的索引</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">依照各个字符出现的顺序创建索引</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">private</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong><span style="font-size: 16px;font-family: Consolas"> Map&lt;Character, Integer&gt; <span style="text-decoration:underline;">createIndexMap(String str, String pat)</span> {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;Character, Integer&gt; idxMap = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">new</span></strong><span style="font-size: 16px;font-family: Consolas"> HashMap&lt;&gt;();</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> idx = 0;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;pat.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(! idxMap.containsKey(pat.charAt(i)) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; idxMap.put(pat.charAt(i), idx ++);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;str.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(! idxMap.containsKey(str.charAt(i)) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; idxMap.put(str.charAt(i), idx ++);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> idxMap;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">private</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong><span style="font-size: 16px;font-family: Consolas"> Map&lt;Character, Integer&gt; createIndexMap02(String str, String pat) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;Character, Integer&gt; idxMap = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">new</span></strong><span style="font-size: 16px;font-family: Consolas"> HashMap&lt;&gt;();</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> idx = 0;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=0; i&lt;pat.length(); i++) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(! idxMap.containsKey(pat.charAt(i)) ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; idxMap.put(pat.charAt(i), idx ++);</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> idxMap;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size:16px;font-family: Consolas">&nbsp;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取给定的字符应该跳转的索引</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F"> [</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">表示在给定的</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中如果</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">str</span></span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">之后的字符为</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">ch</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">的话</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">, </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">能够匹配</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">pattern</span><span style="font-size:16px;font-family: 宋体;color:#3F7F5F">中最长的字符串的长度</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">]</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">获取给定的字符</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">[<span style="text-decoration:underline;">ch</span>]</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">在</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">str</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">中的最长子串</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | i</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// </span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">例如</span><span style="text-decoration:underline;"><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">str</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&quot;<span style="text-decoration:underline;">ababa</span>&quot;, <span style="text-decoration:underline;">ch</span></span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&#39;b&#39;, pattern</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">为</span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">&quot;<span style="text-decoration:underline;">ababaca</span>&quot;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// &nbsp;&nbsp; <span style="text-decoration:underline;">aba</span></span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">// &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="text-decoration:underline;">aba</span></span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">private</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> getTransformTo(String str, Character ch) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> i=str.length()-1; i&gt;=0; i--) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(ch.compareTo(Character.<em>valueOf</em>(str.charAt(i))) == 0 ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> lastI = str.length()-1;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">boolean</span></strong><span style="font-size: 16px;font-family: Consolas"> isOk = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">true</span></strong><span style="font-size: 16px;font-family: Consolas">;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 16px;font-family: Consolas">(</span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">int</span></strong><span style="font-size: 16px;font-family: Consolas"> j = i-1; j&gt;=0; j--) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(Character.<em>compare</em>(str.charAt(j), str.charAt(lastI --)) != 0 ) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; isOk = </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">false</span></strong><span style="font-size: 16px;font-family: Consolas">;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">break</span></strong><span style="font-size: 16px;font-family: Consolas"> ;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 16px;font-family: Consolas">(isOk) {</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> i + 1;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:16px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 16px;font-family: Consolas"> 0;</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; }</span></p><p><span style="font-size: 16px;font-family: Consolas">&nbsp;&nbsp; </span></p><p><span style="font-size: 16px;font-family: Consolas">}</span></p><p><span style="font-family:宋体">&nbsp;</span></p><p><span style="font-family:宋体">&nbsp;</span></p><p><span style="font-family:宋体">&nbsp;</span></p><p>&nbsp;</p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">后面在测试的时候，发现在“aaababaabaababaab”里面查找“aabab”会有遗漏，大家可以debug看下，我针对这种情况作了处理，部分要回过头重复检查， 会影响效率，没想到好方法，欢迎大家指点~~</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">ps : 2014-08-06</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">日，自己回顾下有限自动机，发现部分错漏，自己重新看了遍算法导论，修正了一遍，以此记录。通过回顾，自己归纳下字符串匹配自动机主要是在某个字符匹配失败时，利用已知匹配失败的部分，看是否有部分是模式串P的前缀，以便跳过部分以节省时间。关键是后缀函数的理解, 当然后面几篇模式匹配算法也有用到其他方法，也有几种方法结合的，具体要看业务需要。</span></p><p style="line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">&nbsp;</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">参考：</span></p><p style="margin: 8px 0;line-height: 23px;background: white"><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">1</span><span style="font-size:13px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#333333;letter-spacing:1px">、《Introduction to algorithms》</span></p><p>&nbsp;</p><p><br/></p><p><br/></p><p><br/></p>